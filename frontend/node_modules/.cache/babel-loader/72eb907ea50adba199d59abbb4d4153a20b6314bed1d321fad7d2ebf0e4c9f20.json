{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,TextField,Button,Typography,Box}from'@mui/material';import{styled}from'@mui/system';import logo from'../assets/LogoPrincipal.png';import{useNavigate}from'react-router-dom';import{isAuthenticated}from'../utils/auth';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CircularLogo=styled('img')({width:'350px',height:'200px',borderRadius:'50%',display:'block',margin:'0 auto'});const Login=()=>{const[usuario,setUsuario]=useState('');const[password,setPassword]=useState('');const[errors,setErrors]=useState({});const navigate=useNavigate();useEffect(()=>{if(!isAuthenticated()){navigate('/Login');}},[navigate]);const handleSubmit=async event=>{event.preventDefault();const newErrors={};if(!usuario)newErrors.usuario='El usuario es requerido';if(!password)newErrors.password='La contraseña es requerida';if(Object.keys(newErrors).length>0){setErrors(newErrors);return;}try{const response=await fetch('http://localhost:5000/api/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:usuario,password})});if(!response.ok){const errorData=await response.json();setErrors({submit:errorData.errors?errorData.errors.map(err=>err.msg).join(', '):errorData.msg||'Error en la conexión.'});return;}const data=await response.json();localStorage.setItem('token',data.token);// Almacena el token en localStorage\nnavigate('/');}catch(error){console.error('Error en la conexión:',error);setErrors({submit:'Error en la conexión. Inténtalo más tarde.'});}};return/*#__PURE__*/_jsxs(Container,{maxWidth:\"xs\",sx:{mt:8},children:[/*#__PURE__*/_jsx(CircularLogo,{src:logo,alt:\"Logo\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",align:\"center\",gutterBottom:true,children:\"Iniciar Sesi\\xF3n\"}),/*#__PURE__*/_jsxs(Box,{component:\"form\",noValidate:true,onSubmit:handleSubmit,sx:{mt:1},children:[/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,label:\"Usuario\",margin:\"normal\",value:usuario,onChange:e=>{setUsuario(e.target.value);if(errors.usuario){setErrors({...errors,usuario:undefined});}},error:Boolean(errors.usuario),helperText:errors.usuario}),/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,label:\"Contrase\\xF1a\",type:\"password\",margin:\"normal\",value:password,onChange:e=>{setPassword(e.target.value);if(errors.password){setErrors({...errors,password:undefined});}},error:Boolean(errors.password),helperText:errors.password}),errors.submit&&/*#__PURE__*/_jsx(Typography,{color:\"error\",children:errors.submit}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",fullWidth:true,children:\"Iniciar Sesi\\xF3n\"})]})]});};export default Login;","map":{"version":3,"names":["React","useState","useEffect","Container","TextField","Button","Typography","Box","styled","logo","useNavigate","isAuthenticated","jsx","_jsx","jsxs","_jsxs","CircularLogo","width","height","borderRadius","display","margin","Login","usuario","setUsuario","password","setPassword","errors","setErrors","navigate","handleSubmit","event","preventDefault","newErrors","Object","keys","length","response","fetch","method","headers","body","JSON","stringify","username","ok","errorData","json","submit","map","err","msg","join","data","localStorage","setItem","token","error","console","maxWidth","sx","mt","children","src","alt","variant","align","gutterBottom","component","noValidate","onSubmit","required","fullWidth","label","value","onChange","e","target","undefined","Boolean","helperText","type","color"],"sources":["C:/Users/Administrador/Documents/Proyectos/control_calidad/frontend/src/pages/Login.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Container, TextField, Button, Typography, Box } from '@mui/material';\r\nimport { styled } from '@mui/system';\r\nimport logo from '../assets/LogoPrincipal.png';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { isAuthenticated } from '../utils/auth';\r\n\r\nconst CircularLogo = styled('img')({\r\n    width: '350px',\r\n    height: '200px',\r\n    borderRadius: '50%',\r\n    display: 'block',\r\n    margin: '0 auto',\r\n});\r\n\r\nconst Login = () => {\r\n    const [usuario, setUsuario] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [errors, setErrors] = useState({});\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        if (!isAuthenticated()) {\r\n            navigate('/Login');\r\n        }\r\n    }, [navigate]);\r\n\r\n    const handleSubmit = async (event) => {\r\n        event.preventDefault();\r\n\r\n        const newErrors = {};\r\n        if (!usuario) newErrors.usuario = 'El usuario es requerido';\r\n        if (!password) newErrors.password = 'La contraseña es requerida';\r\n\r\n        if (Object.keys(newErrors).length > 0) {\r\n            setErrors(newErrors);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await fetch('http://localhost:5000/api/auth/login', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({ username: usuario, password }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const errorData = await response.json();\r\n                setErrors({\r\n                    submit: errorData.errors ? errorData.errors.map(err => err.msg).join(', ') : errorData.msg || 'Error en la conexión.'\r\n                });\r\n                return;\r\n            }\r\n\r\n            const data = await response.json();\r\n            localStorage.setItem('token', data.token); // Almacena el token en localStorage\r\n            navigate('/')\r\n        } catch (error) {\r\n            console.error('Error en la conexión:', error);\r\n            setErrors({ submit: 'Error en la conexión. Inténtalo más tarde.' });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Container maxWidth=\"xs\" sx={{ mt: 8 }}>\r\n            <CircularLogo src={logo} alt=\"Logo\" />\r\n            <Typography variant=\"h4\" align=\"center\" gutterBottom>\r\n                Iniciar Sesión\r\n            </Typography>\r\n            <Box component=\"form\" noValidate onSubmit={handleSubmit} sx={{ mt: 1 }}>\r\n                <TextField\r\n                    required\r\n                    fullWidth\r\n                    label=\"Usuario\"\r\n                    margin=\"normal\"\r\n                    value={usuario}\r\n                    onChange={(e) => {\r\n                        setUsuario(e.target.value);\r\n                        if (errors.usuario) {\r\n                            setErrors({ ...errors, usuario: undefined });\r\n                        }\r\n                    }}\r\n                    error={Boolean(errors.usuario)}\r\n                    helperText={errors.usuario}\r\n                />\r\n                <TextField\r\n                    required\r\n                    fullWidth\r\n                    label=\"Contraseña\"\r\n                    type=\"password\"\r\n                    margin=\"normal\"\r\n                    value={password}\r\n                    onChange={(e) => {\r\n                        setPassword(e.target.value);\r\n                        if (errors.password) {\r\n                            setErrors({ ...errors, password: undefined });\r\n                        }\r\n                    }}\r\n                    error={Boolean(errors.password)}\r\n                    helperText={errors.password}\r\n                />\r\n                {errors.submit && <Typography color=\"error\">{errors.submit}</Typography>}\r\n                <Button type=\"submit\" variant=\"contained\" color=\"primary\" fullWidth>\r\n                    Iniciar Sesión\r\n                </Button>\r\n            </Box>\r\n        </Container>\r\n    );\r\n};\r\n\r\nexport default Login;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}